<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Kajiki XML Templates &#8212; Kajiki 1.0.0.dev1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=c058f7c8" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=c4f33018"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Kajiki Text Templates" href="text-templates.html" />
    <link rel="prev" title="Kajiki Templating Basics" href="templating-basics.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="kajiki-xml-templates">
<h1>Kajiki XML Templates<a class="headerlink" href="#kajiki-xml-templates" title="Link to this heading">¶</a></h1>
<p>Kajiki provides a full-featured XML-based template engine that guarantees
well-formed output when generating HTML and XML.  This document describes that
language.  Templates are XML files that include template directives that control
how the template is rendered and expressions that are substituted into the
generated text at render time.</p>
<p>Please see <a class="reference internal" href="templating-basics.html"><span class="doc">Kajiki Templating Basics</span></a> for general information on embedding Python
code in templates.</p>
<section id="output-modes">
<h2>Output Modes<a class="headerlink" href="#output-modes" title="Link to this heading">¶</a></h2>
<p>Although Kajiki XML templates must be well-formed XML documents, Kajiki is capable of
rendering HTML or XML.  By default, Kajiki will inspect the doctype of the
template to determine how to render:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tpl_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;&lt;!DOCTYPE html&gt;</span>
<span class="gp">... </span><span class="s1">&lt;html&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;head&gt;&lt;!-- Some stuff here --&gt;&lt;/head&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;body&gt;</span>
<span class="gp">... </span><span class="s1">        &lt;form&gt;</span>
<span class="gp">... </span><span class="s1">            &lt;input type=&quot;checkbox&quot; checked=&quot;checked&quot;/&gt;</span>
<span class="gp">... </span><span class="s1">            &lt;select&gt;</span>
<span class="gp">... </span><span class="s1">                &lt;option selected=&quot;selected&quot;&gt;One&lt;/option&gt;</span>
<span class="gp">... </span><span class="s1">                &lt;option&gt;Two&lt;/option&gt;</span>
<span class="gp">... </span><span class="s1">                &lt;option&gt;Three&lt;/option&gt;</span>
<span class="gp">... </span><span class="s1">            &lt;/select&gt;</span>
<span class="gp">... </span><span class="s1">        &lt;/form&gt;</span>
<span class="gp">... </span><span class="s1">    &lt;/body&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/html&gt;&#39;&#39;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">kajiki</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="n">tpl_text</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="go">&lt;!DOCTYPE html&gt;</span>
<span class="go">&lt;html&gt;</span>
<span class="go">    &lt;head&gt;&lt;!--  Some stuff here  --&gt;&lt;/head&gt;</span>
<span class="go">    &lt;body&gt;</span>
<span class="go">        &lt;form&gt;</span>
<span class="go">            &lt;input checked type=&quot;checkbox&quot;&gt;</span>
<span class="go">            &lt;select&gt;</span>
<span class="go">                &lt;option selected&gt;One&lt;/option&gt;</span>
<span class="go">                &lt;option&gt;Two&lt;/option&gt;</span>
<span class="go">                &lt;option&gt;Three&lt;/option&gt;</span>
<span class="go">            &lt;/select&gt;</span>
<span class="go">        &lt;/form&gt;</span>
<span class="go">    &lt;/body&gt;</span>
<span class="go">&lt;/html&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># If we want to override the detected type, we can pass a &#39;mode&#39; param</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="n">tpl_text</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xml&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="go">&lt;!DOCTYPE html&gt;</span>
<span class="go">&lt;html&gt;</span>
<span class="go">    &lt;head&gt;&lt;!--  Some stuff here  --&gt;&lt;/head&gt;</span>
<span class="go">    &lt;body&gt;</span>
<span class="go">        &lt;form&gt;</span>
<span class="go">            &lt;input checked=&quot;checked&quot; type=&quot;checkbox&quot;/&gt;</span>
<span class="go">            &lt;select&gt;</span>
<span class="go">                &lt;option selected=&quot;selected&quot;&gt;One&lt;/option&gt;</span>
<span class="go">                &lt;option&gt;Two&lt;/option&gt;</span>
<span class="go">                &lt;option&gt;Three&lt;/option&gt;</span>
<span class="go">            &lt;/select&gt;</span>
<span class="go">        &lt;/form&gt;</span>
<span class="go">    &lt;/body&gt;</span>
<span class="go">&lt;/html&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># We can also omit the generated DOCTYPE by specifying the template</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># is a fragment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="n">tpl_text</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;xml&#39;</span><span class="p">,</span> <span class="n">is_fragment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
<span class="go">&lt;html&gt;</span>
<span class="go">    &lt;head&gt;&lt;!--  Some stuff here  --&gt;&lt;/head&gt;</span>
<span class="go">    &lt;body&gt;</span>
<span class="go">        &lt;form&gt;</span>
<span class="go">            &lt;input checked=&quot;checked&quot; type=&quot;checkbox&quot;/&gt;</span>
<span class="go">            &lt;select&gt;</span>
<span class="go">                &lt;option selected=&quot;selected&quot;&gt;One&lt;/option&gt;</span>
<span class="go">                &lt;option&gt;Two&lt;/option&gt;</span>
<span class="go">                &lt;option&gt;Three&lt;/option&gt;</span>
<span class="go">            &lt;/select&gt;</span>
<span class="go">        &lt;/form&gt;</span>
<span class="go">    &lt;/body&gt;</span>
<span class="go">&lt;/html&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Kajiki, you can use normal XML comments, and the comments will exist in the
generated markup.  If you wish the comments to be removed before rendering the
document, you can begin the comment with the syntax <cite>&lt;!–!</cite> instead of <cite>&lt;!–</cite>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;div&gt;</span>
<span class="gp">... </span><span class="s1">&lt;!-- This comment is preserved.</span>
<span class="gp">... </span><span class="s1">--&gt;&lt;!--! This comment is stripped. --&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/div&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;</span>
<span class="go">&lt;!--  This comment is preserved.</span>
<span class="go"> --&gt;</span>
<span class="go">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
</section>
<section id="basic-expressions">
<h2>Basic Expressions<a class="headerlink" href="#basic-expressions" title="Link to this heading">¶</a></h2>
<p>Let’s start with a hello world template:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;Hello, $name!&lt;/div&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;world&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;Hello, world!&lt;/div&gt;</span>
</pre></div>
</div>
<p>By default, the $-syntax picks up any identifiers following it, as well as any
periods.  If you want something more explicit, use the extended expression form
as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;Hello, 2+2 is ${2+2}&lt;/div&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;Hello, 2+2 is 4&lt;/div&gt;</span>
</pre></div>
</div>
<p>If you wish to include a literal $, simply double it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;The price is $$$</span><span class="si">{price}</span><span class="s1">&lt;/div&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">price</span><span class="o">=</span><span class="s1">&#39;5.00&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;The price is $5.00&lt;/div&gt;</span>
</pre></div>
</div>
<p>You can also include expressions in template attributes:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div id=&quot;$foo&quot;&gt;Bar&lt;/div&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="s1">&#39;baz&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div id=&quot;baz&quot;&gt;Bar&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="control-flow">
<h2>Control Flow<a class="headerlink" href="#control-flow" title="Link to this heading">¶</a></h2>
<p>Kajiki provides several directives that affect the rendering of a template.  This
section describes the various directives.  Directives in text templates can
either appear as special attributes on tags prefixed by <cite>py:</cite> or as standalone
tags whose tagname is prefixed by <cite>py:</cite>.</p>
<section id="py-if-py-else">
<h3>py:if, py:else<a class="headerlink" href="#py-if-py-else" title="Link to this heading">¶</a></h3>
<p>Only render the enclosed content if the expression evaluates to a truthy value:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;py:if test=&quot;foo&quot;&gt;bar&lt;/py:if&gt;&lt;py:else&gt;baz&lt;/py:else&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;bar&lt;/div&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;baz&lt;/div&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;span py:if=&quot;foo&quot;&gt;bar&lt;/span&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;&lt;span&gt;bar&lt;/span&gt;&lt;/div&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="py-switch-py-case-py-else">
<h3>py:switch, py:case, py:else<a class="headerlink" href="#py-switch-py-case-py-else" title="Link to this heading">¶</a></h3>
<p>Perform multiple tests to render one of several alternatives.  The first matching
<cite>case</cite> is rendered, and if no <cite>case</cite> matches, the <cite>else</cite> branch is rendered:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;div&gt;</span>
<span class="gp">... </span><span class="s1">$i is &lt;py:switch test=&quot;i % 2&quot;&gt;</span>
<span class="gp">... </span><span class="s1">&lt;py:case value=&quot;0&quot;&gt;even&lt;/py:case&gt;</span>
<span class="gp">... </span><span class="s1">&lt;py:else&gt;odd&lt;/py:else&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/py:switch&gt;&lt;/div&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;</span>
<span class="go">4 is even&lt;/div&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;</span>
<span class="go">3 is odd&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="py-for">
<h3>py:for<a class="headerlink" href="#py-for" title="Link to this heading">¶</a></h3>
<p>Repeatedly render the content for each item in an iterable:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;ul&gt;</span>
<span class="gp">... </span><span class="s1">&lt;li py:for=&quot;x in range(sz)&quot;&gt;$x&lt;/li&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/ul&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">sz</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;ul&gt;</span>
<span class="go">&lt;li&gt;0&lt;/li&gt;&lt;li&gt;1&lt;/li&gt;&lt;li&gt;2&lt;/li&gt;</span>
<span class="go">&lt;/ul&gt;</span>
</pre></div>
</div>
</section>
<section id="py-def">
<h3>py:def<a class="headerlink" href="#py-def" title="Link to this heading">¶</a></h3>
<p>Defines a function that can be used elsewhere in the template:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;div</span>
<span class="gp">... </span><span class="s1">&gt;&lt;py:def function=&quot;evenness(n)&quot;</span>
<span class="gp">... </span><span class="s1">&gt;&lt;py:if test=&quot;n%2==0&quot;&gt;even&lt;/py:if&gt;&lt;py:else&gt;odd&lt;/py:else&gt;&lt;/py:def</span>
<span class="gp">... </span><span class="s1">&gt;&lt;ul&gt;</span>
<span class="gp">... </span><span class="s1">&lt;li py:for=&quot;x in range(sz)&quot;&gt;$x is ${evenness(x)}&lt;/li&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/ul&gt;&lt;/div&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">sz</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;&lt;ul&gt;</span>
<span class="go">&lt;li&gt;0 is even&lt;/li&gt;&lt;li&gt;1 is odd&lt;/li&gt;&lt;li&gt;2 is even&lt;/li&gt;</span>
<span class="go">&lt;/ul&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="py-call">
<h3>py:call<a class="headerlink" href="#py-call" title="Link to this heading">¶</a></h3>
<p>Call a function, passing a block of template code as a ‘lambda’ parameter.  Note
that this is a special case of calling when you wish to insert some templated text in the
expansion of a function call.  In normal circumstances, you would just use <cite>${my_function(args)}</cite>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;div</span>
<span class="gp">... </span><span class="s1">&gt;&lt;py:def function=&quot;quote(caller, speaker)&quot;</span>
<span class="gp">... </span><span class="s1">&gt;&lt;ul&gt;</span>
<span class="gp">... </span><span class="s1">   &lt;li py:for=&quot;i in range(sz)&quot;&gt;Quoth $speaker, ${caller(i)}&lt;/li&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/ul&gt;&lt;/py:def</span>
<span class="gp">... </span><span class="s1">&gt;&lt;py:call args=&quot;n&quot; function=&quot;quote(</span><span class="si">%c</span><span class="s1">aller, &#39;the raven&#39;)&quot;</span>
<span class="gp">... </span><span class="s1">&gt;Nevermore $n&lt;/py:call&gt;&lt;/div&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">sz</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;&lt;ul&gt;</span>
<span class="go">   &lt;li&gt;Quoth the raven, Nevermore 0&lt;/li&gt;&lt;li&gt;Quoth the raven, Nevermore 1&lt;/li&gt;&lt;li&gt;Quoth the raven, Nevermore 2&lt;/li&gt;</span>
<span class="go">&lt;/ul&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="py-include">
<h3>py:include<a class="headerlink" href="#py-include" title="Link to this heading">¶</a></h3>
<p>Includes the text of another template verbatim.  The precise semantics of this
tag depend on the <cite>TemplateLoader</cite> being used, as the <cite>TemplateLoader</cite> is used to
parse the name of the template being included and render its contents into the
current template.  For instance, with the <cite>FileLoader</cite>, you might use the
following:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;py:include</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;path/to/base.txt&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>whereas in the <cite>PackageLoader</cite> you would use</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;py:include</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;package1.package2.base&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</section>
<section id="py-import">
<h3>py:import<a class="headerlink" href="#py-import" title="Link to this heading">¶</a></h3>
<p>With <cite>py:import</cite>, you can make the functions defined in another template available
without expanding the full template in-place.  Suppose that we saved the
following template in a file <cite>lib.xml</cite>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;py:def</span><span class="w"> </span><span class="na">function=</span><span class="s">&quot;evenness(n)&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;py:if</span><span class="w"> </span><span class="na">test=</span><span class="s">&quot;n%2==0&quot;</span><span class="nt">&gt;</span>even<span class="nt">&lt;/py:if&gt;&lt;py:else&gt;</span>odd<span class="nt">&lt;/py:else&gt;</span>
<span class="nt">&lt;/py:def&gt;</span>
</pre></div>
</div>
<p>Then (using the <cite>FileLoader</cite>) we could write a template using the <cite>evenness</cite>
function as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>
<span class="w">   </span><span class="nt">&lt;py:import</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;lib.xml&quot;</span><span class="w"> </span><span class="na">alias=</span><span class="s">&quot;lib&quot;</span><span class="nt">/&gt;</span>
<span class="w">   </span><span class="nt">&lt;ul&gt;</span>
<span class="w">      </span><span class="nt">&lt;li</span><span class="w"> </span><span class="na">py:for=</span><span class="s">&quot;i in range(sz)&quot;</span><span class="nt">&gt;</span>$i<span class="w"> </span>is<span class="w"> </span>${lib.evenness(i)}<span class="nt">&lt;/li&gt;</span>
<span class="w">   </span><span class="nt">&lt;/ul&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<section id="py-with">
<h4>py:with<a class="headerlink" href="#py-with" title="Link to this heading">¶</a></h4>
<p>Using <cite>py:with</cite>, you can temporarily assign variables values for the extent of
the block:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;div py:with=&quot;a=&#39;foo&#39;&quot;&gt;</span>
<span class="gp">... </span><span class="s1">&lt;div&gt;$a&lt;/div&gt;</span>
<span class="gp">... </span><span class="s1">&lt;div py:with=&quot;a=5&quot;&gt;$a&lt;/div&gt;</span>
<span class="gp">... </span><span class="s1">&lt;div&gt;$a&lt;/div&gt;</span>
<span class="gp">... </span><span class="s1">&lt;/div&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;</span>
<span class="go">&lt;div&gt;foo&lt;/div&gt;</span>
<span class="go">&lt;div&gt;5&lt;/div&gt;</span>
<span class="go">&lt;div&gt;foo&lt;/div&gt;</span>
<span class="go">&lt;/div&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="content-generation">
<h2>Content Generation<a class="headerlink" href="#content-generation" title="Link to this heading">¶</a></h2>
<section id="py-attrs">
<h3>py:attrs<a class="headerlink" href="#py-attrs" title="Link to this heading">¶</a></h3>
<p>With the <cite>py:attrs</cite> custom attribute, you can include dynamic attributes in an
xml/html tag by passing a either a Python dict or a list of pairs:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div py:attrs=&quot;attrs&quot;/&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;bar&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div class=&quot;bar&quot; id=&quot;foo&quot;/&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;foo&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)]))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div class=&quot;bar&quot; id=&quot;foo&quot;/&gt;</span>
</pre></div>
</div>
<p>Any attribute values that evaluate to <cite>None</cite> will not be emitted in the generated
markup:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div py:attrs=&quot;attrs&quot;/&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">}))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div id=&quot;foo&quot;/&gt;</span>
</pre></div>
</div>
</section>
<section id="py-strip">
<h3>py:strip<a class="headerlink" href="#py-strip" title="Link to this heading">¶</a></h3>
<p>With <code class="docutils literal notranslate"><span class="pre">py:strip</span></code>, you can remove the tag to which the attribute is attached
without removing the content of the tag:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;div py:strip=&quot;True&quot;&gt;Foo&lt;/div&gt;&lt;/div&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">()</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;Foo&lt;/div&gt;</span>
</pre></div>
</div>
<p>As a shorthand, if the value of the <code class="docutils literal notranslate"><span class="pre">py:strip</span></code> attribute is empty, that has
the same effect as using a truth value (i.e. the element is stripped).</p>
</section>
<section id="py-content">
<h3>py:content<a class="headerlink" href="#py-content" title="Link to this heading">¶</a></h3>
<p>With <cite>py:content</cite>, you can remove the tag to which the attribute is attached
without removing the content of the tag:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div py:content=&quot;content&quot;/&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s2">&quot;Foo&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;Foo&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="py-replace">
<h3>py:replace<a class="headerlink" href="#py-replace" title="Link to this heading">¶</a></h3>
<p>With <cite>py:replace</cite>, you can replace the entire tag to which the document is
attached and its children:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&lt;div py:replace=&quot;content&quot;/&gt;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="s2">&quot;Foo&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">Foo</span>
</pre></div>
</div>
</section>
</section>
<section id="inheritance-py-extends-py-block">
<h2>Inheritance (py:extends, py:block)<a class="headerlink" href="#inheritance-py-extends-py-block" title="Link to this heading">¶</a></h2>
<p>Kajiki supports a concept of inheritance whereby child templates can extend
parent templates, replacing their “methods” (functions) and “blocks” (to be defined below).
For instance, consider the following template “parent.xml”:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>
<span class="w">   </span><span class="nt">&lt;py:def</span><span class="w"> </span><span class="na">function=</span><span class="s">&quot;greet(name)&quot;</span>
<span class="w">      </span><span class="nt">&gt;</span>Hello,<span class="w"> </span>$name!<span class="nt">&lt;/py:def&gt;</span>
<span class="w">   </span><span class="nt">&lt;py:def</span><span class="w"> </span><span class="na">function=</span><span class="s">&quot;sign(name)&quot;</span>
<span class="w">      </span><span class="nt">&gt;</span>Sincerely,<span class="nt">&lt;br/&gt;</span>
<span class="w">      </span><span class="nt">&lt;em&gt;</span>$name<span class="nt">&lt;/em&gt;&lt;/py:def&gt;</span>
<span class="w">   </span>${greet(to)}

<span class="w">   </span><span class="nt">&lt;p</span><span class="w"> </span><span class="na">py:block=</span><span class="s">&quot;body&quot;</span><span class="nt">&gt;</span>It<span class="w"> </span>was<span class="w"> </span>good<span class="w"> </span>seeing<span class="w"> </span>you<span class="w"> </span>last<span class="w"> </span>Friday.
<span class="w">   </span>Thanks<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>gift!<span class="nt">&lt;/p&gt;</span>

<span class="w">   </span>${sign(from_)}
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>This would render to something similar to the following (assuming a context of
<cite>dict(to=Mark, from_=Rick)</cite>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>
<span class="w">   </span>Hello,<span class="w"> </span>Mark!

<span class="w">   </span><span class="nt">&lt;p&gt;</span>It<span class="w"> </span>was<span class="w"> </span>good<span class="w"> </span>seeing<span class="w"> </span>you<span class="w"> </span>last<span class="w"> </span>friday.
<span class="w">   </span>Thanks<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>gift!<span class="nt">&lt;/p&gt;</span>

<span class="w">   </span>Sincerely,<span class="w"> </span><span class="nt">&lt;br/&gt;</span>
<span class="w">   </span>Rick
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Now we can extend “parent.xml” with “child.xml”:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;py:extends</span><span class="w"> </span><span class="na">href=</span><span class="s">&quot;parent.xml&quot;</span><span class="nt">&gt;</span>
<span class="w">   </span><span class="nt">&lt;py:def</span><span class="w"> </span><span class="na">function=</span><span class="s">&quot;greet(name)&quot;</span>
<span class="w">   </span><span class="nt">&gt;</span>Dear<span class="w"> </span>$name:<span class="nt">&lt;/py:def&gt;</span>
<span class="w">   </span><span class="nt">&lt;py:block</span><span class="w"> </span><span class="na">name=</span><span class="s">&quot;body&quot;</span><span class="nt">&gt;</span>${parent_block()}
<span class="w">   </span><span class="nt">&lt;p&gt;</span>And<span class="w"> </span>don&#39;t<span class="w"> </span>forget<span class="w"> </span>you<span class="w"> </span>owe<span class="w"> </span>me<span class="w"> </span>money!<span class="nt">&lt;/p&gt;</span>
<span class="w">   </span><span class="nt">&lt;/py:block&gt;</span>
<span class="nt">&lt;/py:extends&gt;</span>
</pre></div>
</div>
<p>Rendering this template would then give us:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;div&gt;</span>
<span class="w">   </span>Dear,<span class="w"> </span>Mark:

<span class="w">   </span><span class="nt">&lt;p&gt;</span>It<span class="w"> </span>was<span class="w"> </span>good<span class="w"> </span>seeing<span class="w"> </span>you<span class="w"> </span>last<span class="w"> </span>friday.
<span class="w">   </span>Thanks<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>gift!<span class="nt">&lt;/p&gt;</span>
<span class="w">   </span><span class="nt">&lt;p&gt;</span>And<span class="w"> </span>don&#39;t<span class="w"> </span>forget<span class="w"> </span>you<span class="w"> </span>owe<span class="w"> </span>me<span class="w"> </span>money!<span class="nt">&lt;/p&gt;</span>

<span class="w">   </span>Sincerely,<span class="w"> </span><span class="nt">&lt;br/&gt;</span>
<span class="w">   </span>Rick
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Notice how in the child block, we have overridden both the block “body” and the
function “greet.”  When overriding a block, we always have access to the parent
template’s block of the same name via the <cite>parent_block()</cite> function.</p>
<p>If you ever need to access the parent template itself (perhaps to call another
function), kajiki provides access to a special variable in child templates
<cite>parent</cite>.  Likewise, if a template is being extended, the variable <cite>child</cite> is
available.  Kajiki also provides the special variables <cite>local</cite> (the template
currently being defined) and <cite>self</cite> (the child-most template of an inheritance
chain).  The following example illustrates these variables in a 3-level
inheritance hierarchy:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parent</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;div</span>
<span class="gp">... </span><span class="s1">&gt;&lt;h1 py:def=&quot;header()&quot;&gt;Header name=$name&lt;/h1</span>
<span class="gp">... </span><span class="s1">&gt;&lt;h6 py:def=&quot;footer()&quot;&gt;Footer&lt;/h6</span>
<span class="gp">... </span><span class="s1">&gt;&lt;div py:def=&quot;body()&quot;&gt;</span>
<span class="gp">... </span><span class="s1">id() = ${id()}</span>
<span class="gp">... </span><span class="s1">local.id() = ${local.id()}</span>
<span class="gp">... </span><span class="s1">self.id() = ${self.id()}</span>
<span class="gp">... </span><span class="s1">child.id() = ${child.id()}</span>
<span class="gp">... </span><span class="s1">&lt;/div&gt;&lt;span py:def=&quot;id()&quot;&gt;parent&lt;/span&gt;</span>
<span class="gp">... </span><span class="s1">${header()}</span>
<span class="gp">... </span><span class="s1">${body()}</span>
<span class="gp">... </span><span class="s1">${footer()}</span>
<span class="gp">... </span><span class="s1">&lt;/div&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mid</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;py:extends href=&quot;parent.html&quot;</span>
<span class="gp">... </span><span class="s1">&gt;&lt;span py:def=&quot;id()&quot;&gt;mid&lt;/span</span>
<span class="gp">... </span><span class="s1">&gt;&lt;/py:extends&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">child</span><span class="o">=</span><span class="n">kajiki</span><span class="o">.</span><span class="n">XMLTemplate</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;&lt;py:extends href=&quot;mid.html&quot;</span>
<span class="gp">... </span><span class="s1">&gt;&lt;span py:def=&quot;id()&quot;&gt;child&lt;/span</span>
<span class="gp">... </span><span class="s1">&gt;&lt;div py:def=&quot;body()&quot;&gt;</span>
<span class="gp">... </span><span class="s1">&lt;h2&gt;Child Body&lt;/h2&gt;</span>
<span class="gp">... </span><span class="s1">${parent.body()}</span>
<span class="gp">... </span><span class="s1">&lt;/div&gt;&lt;/py:extends&gt;&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span> <span class="o">=</span> <span class="n">kajiki</span><span class="o">.</span><span class="n">MockLoader</span><span class="p">({</span>
<span class="gp">... </span><span class="s1">&#39;parent.html&#39;</span><span class="p">:</span><span class="n">parent</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;mid.html&#39;</span><span class="p">:</span><span class="n">mid</span><span class="p">,</span>
<span class="gp">... </span><span class="s1">&#39;child.html&#39;</span><span class="p">:</span><span class="n">child</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Template</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">import_</span><span class="p">(</span><span class="s1">&#39;child.html&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Template</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Rick&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">render</span><span class="p">())</span>
<span class="go">&lt;div&gt;</span>
<span class="go">&lt;h1&gt;Header name=Rick&lt;/h1&gt;</span>
<span class="go">&lt;div&gt;</span>
<span class="go">&lt;h2&gt;Child Body&lt;/h2&gt;</span>
<span class="go">&lt;div&gt;</span>
<span class="go">id() = &lt;span&gt;child&lt;/span&gt;</span>
<span class="go">local.id() = &lt;span&gt;parent&lt;/span&gt;</span>
<span class="go">self.id() = &lt;span&gt;child&lt;/span&gt;</span>
<span class="go">child.id() = &lt;span&gt;mid&lt;/span&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;/div&gt;</span>
<span class="go">&lt;h6&gt;Footer&lt;/h6&gt;</span>
<span class="go">&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="summary-of-directives">
<h2>Summary of Directives<a class="headerlink" href="#summary-of-directives" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Directive</p></th>
<th class="head"><p>Usable as an attribute</p></th>
<th class="head"><p>Usable as a separate element</p></th>
<th class="head"><p>When used as a separate element, requires attributes named</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>py:if</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>test</p></td>
</tr>
<tr class="row-odd"><td><p>py:else</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>py:switch</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>test</p></td>
</tr>
<tr class="row-odd"><td><p>py:case</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>value</p></td>
</tr>
<tr class="row-even"><td><p>py:for</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>each</p></td>
</tr>
<tr class="row-odd"><td><p>py:def</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>function</p></td>
</tr>
<tr class="row-even"><td><p>py:call</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>args, function</p></td>
</tr>
<tr class="row-odd"><td><p>py:include</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>href</p></td>
</tr>
<tr class="row-even"><td><p>py:import</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>href</p></td>
</tr>
<tr class="row-odd"><td><p>py:with</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>vars</p></td>
</tr>
<tr class="row-even"><td><p>py:attrs</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>py:strip</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>py:content</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>py:replace</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>value</p></td>
</tr>
<tr class="row-even"><td><p>py:extends</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>href</p></td>
</tr>
<tr class="row-odd"><td><p>py:block</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>name</p></td>
</tr>
</tbody>
</table>
</section>
<section id="built-in-functions">
<h2>Built-in functions<a class="headerlink" href="#built-in-functions" title="Link to this heading">¶</a></h2>
<p>The following functions are available by default in template code,
in addition to the standard built-ins that are available to all Python code.</p>
<section id="defined-name">
<h3>defined(name)<a class="headerlink" href="#defined-name" title="Link to this heading">¶</a></h3>
<p>This function determines whether a variable of the specified name exists in the context data, and returns True if it does.</p>
<p>When would you use it? Well, suppose you tried the following template snippet:</p>
<blockquote>
<div><p>&lt;h3 py:if=’user’&gt;$user.name&lt;/h3&gt;</p>
</div></blockquote>
<p>If you don’t pass, from your python code, a “user” variable to the template,
the above code will fail with this exception:
<code class="docutils literal notranslate"><span class="pre">NameError:</span> <span class="pre">global</span> <span class="pre">name</span> <span class="pre">'user'</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">defined</span></code>. This is undesired!</p>
<p>Following Genshi, Kajiki offers the <code class="docutils literal notranslate"><span class="pre">defined()</span></code> function to make
that condition possible, so you can write this:</p>
<blockquote>
<div><p>&lt;h3 py:if=”defined(‘user’)”&gt;$user.name&lt;/h3&gt;</p>
</div></blockquote>
</section>
<section id="literal-text">
<h3>literal(text)<a class="headerlink" href="#literal-text" title="Link to this heading">¶</a></h3>
<p>All good templating languages escape text by default to avoid certain attacks.
But sometimes you have an HTML snippet that you wish to include in a page,
and you know the HTML is safe.</p>
<p>The literal() function marks a given string as being safe for inclusion,
meaning it will not be escaped in the serialization stage. Use this with care,
as not escaping a user-provided string may allow malicious users to open
your web site to cross-site scripting attacks. Example:</p>
<blockquote>
<div><p>${literal(name_of_the_variable_containing_the_html)}</p>
</div></blockquote>
<p>Kajiki is a reimplementation of most of Genshi and, since Genshi has a
<code class="docutils literal notranslate"><span class="pre">Markup()</span></code> function for the same purpose, we provide <code class="docutils literal notranslate"><span class="pre">Markup()</span></code> as a
synonym, too.</p>
</section>
<section id="value-of-name-default-none">
<h3>value_of(name, default=None)<a class="headerlink" href="#value-of-name-default-none" title="Link to this heading">¶</a></h3>
<p>This function returns the value of the variable with the specified name
if such a variable is defined, and returns the value of the default parameter
if no such variable is defined.</p>
<p>Genshi has this, too. Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;div py:if=&quot;value_of(&#39;explanation&#39;)&quot;&gt;${explanation}&lt;/div&gt;
</pre></div>
</div>
<p>In the above example, the div will only appear in the output if the
<code class="docutils literal notranslate"><span class="pre">explanation</span></code> variable exists in the context and has a truish value.
(Remember in Python, None and the empty string are not truish, they are
evaluated as False.)</p>
</section>
</section>
<section id="tips-on-writing-your-templates">
<h2>Tips on writing your templates<a class="headerlink" href="#tips-on-writing-your-templates" title="Link to this heading">¶</a></h2>
<p>Kajiki takes XML as input, with the exception that it recognizes HTML entities
in addition to XML entities. (HTML has many more entities than XML;
for instance, XML does not define <code class="docutils literal notranslate"><span class="pre">&amp;nbsp</span></code>).</p>
<p>If your template contains complex content in <code class="docutils literal notranslate"><span class="pre">&lt;style&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> tags,
you should either:</p>
<ol class="arabic">
<li><p>Externalize these contents onto their own files, or</p></li>
<li><p>Remembering that Kajiki takes XML as input, use CDATA sections inside
these tags in order to escape characters that are illegal in XML, such as
<code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;style&gt;&lt;![CDATA[
    html &gt; body { display: none; }
]]&gt;&lt;/style&gt;
&lt;script&gt;&lt;![CDATA[
    if (1 &lt; 2) { document.write(&quot;&lt;p&gt;Albatross!!!&lt;/p&gt;&quot;); }
]]&gt;&lt;/script&gt;
</pre></div>
</div>
</li>
</ol>
<p>This is not necessary when you are writing HTML because HTML defines that the
content of <code class="docutils literal notranslate"><span class="pre">&lt;style&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;script&gt;</span></code> tags is CDATA by default. However,
Kajiki takes XML as input.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/marlin.png" alt="Logo" />
    
    <h1 class="logo logo-name">Kajiki</h1>
    
  </a>
</p>



<p class="blurb">Fast XML and text templates for Python</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jackrosenthal&repo=kajiki&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="templating-basics.html">Kajiki Templating Basics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Kajiki XML Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#output-modes">Output Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-expressions">Basic Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#control-flow">Control Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#content-generation">Content Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inheritance-py-extends-py-block">Inheritance (py:extends, py:block)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary-of-directives">Summary of Directives</a></li>
<li class="toctree-l2"><a class="reference internal" href="#built-in-functions">Built-in functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tips-on-writing-your-templates">Tips on writing your templates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="text-templates.html">Kajiki Text Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrating_from_genshi.html">Migrating from Genshi</a></li>
<li class="toctree-l1"><a class="reference internal" href="i18n.html">Internationalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Kajiki Runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">CHANGES</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="templating-basics.html" title="previous chapter">Kajiki Templating Basics</a></li>
      <li>Next: <a href="text-templates.html" title="next chapter">Kajiki Text Templates</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2010-2021, Rick Copeland, Nando Florestan, Alessandro Molina, and Jack Rosenthal.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.0.2</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/xml-templates.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jackrosenthal/kajiki" class="github">
        <img src="_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>